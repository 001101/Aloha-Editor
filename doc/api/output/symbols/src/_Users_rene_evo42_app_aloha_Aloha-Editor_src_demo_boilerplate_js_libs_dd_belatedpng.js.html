<html><head><meta http-equiv="content-type" content="text/html; charset=utf8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="COMM">/**
<span class='line'>  2</span> * DD_belatedPNG: Adds IE6 support: PNG images for CSS background-image and HTML &lt;IMG/>.
<span class='line'>  3</span> * Author: Drew Diller
<span class='line'>  4</span> * Email: drew.diller@gmail.com
<span class='line'>  5</span> * URL: http://www.dillerdesign.com/experiment/DD_belatedPNG/
<span class='line'>  6</span> * Version: 0.0.8a
<span class='line'>  7</span> * Licensed under the MIT License: http://dillerdesign.com/experiment/DD_belatedPNG/#license
<span class='line'>  8</span> *
<span class='line'>  9</span> * Example usage:
<span class='line'> 10</span> * DD_belatedPNG.fix('.png_bg'); // argument is a CSS selector
<span class='line'> 11</span> * DD_belatedPNG.fixPng( someNode ); // argument is an HTMLDomElement
<span class='line'> 12</span> **/</span><span class="WHIT">
<span class='line'> 13</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">DD_belatedPNG</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">ns</span><span class="PUNC">:</span><span class="STRN">"DD_belatedPNG"</span><span class="PUNC">,</span><span class="NAME">imgSize</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">delay</span><span class="PUNC">:</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NAME">nodesFixed</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">createVmlNameSpace</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">document.namespaces</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">document.namespaces</span><span class="PUNC">[</span><span class="NAME">this.ns</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">document.namespaces.add</span><span class="PUNC">(</span><span class="NAME">this.ns</span><span class="PUNC">,</span><span class="STRN">"urn:schemas-microsoft-com:vml"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createVmlStyleSheet</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"style"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.setAttribute</span><span class="PUNC">(</span><span class="STRN">"media"</span><span class="PUNC">,</span><span class="STRN">"screen"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">document.documentElement.firstChild.insertBefore</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">document.documentElement.firstChild.firstChild</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.styleSheet</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.styleSheet</span><span class="PUNC">;</span><span class="NAME">b.addRule</span><span class="PUNC">(</span><span class="NAME">this.ns</span><span class="PUNC">+</span><span class="STRN">"\\:*"</span><span class="PUNC">,</span><span class="STRN">"{behavior:url(#default#VML)}"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.addRule</span><span class="PUNC">(</span><span class="NAME">this.ns</span><span class="PUNC">+</span><span class="STRN">"\\:shape"</span><span class="PUNC">,</span><span class="STRN">"position:absolute;"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.addRule</span><span class="PUNC">(</span><span class="STRN">"img."</span><span class="PUNC">+</span><span class="NAME">this.ns</span><span class="PUNC">+</span><span class="STRN">"_sizeFinder"</span><span class="PUNC">,</span><span class="STRN">"behavior:none; border:none; position:absolute; z-index:-1; top:-10000px; visibility:hidden;"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.screenStyleSheet</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"style"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.setAttribute</span><span class="PUNC">(</span><span class="STRN">"media"</span><span class="PUNC">,</span><span class="STRN">"print"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">document.documentElement.firstChild.insertBefore</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">document.documentElement.firstChild.firstChild</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.styleSheet</span><span class="PUNC">;</span><span class="NAME">a.addRule</span><span class="PUNC">(</span><span class="NAME">this.ns</span><span class="PUNC">+</span><span class="STRN">"\\:*"</span><span class="PUNC">,</span><span class="STRN">"{display: none !important;}"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.addRule</span><span class="PUNC">(</span><span class="STRN">"img."</span><span class="PUNC">+</span><span class="NAME">this.ns</span><span class="PUNC">+</span><span class="STRN">"_sizeFinder"</span><span class="PUNC">,</span><span class="STRN">"{display: none !important;}"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">readPropertyChange</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">event.srcElement</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">b.vmlInitiated</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">event.propertyName.search</span><span class="PUNC">(</span><span class="STRN">"background"</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">||</span><span class="NAME">event.propertyName.search</span><span class="PUNC">(</span><span class="STRN">"border"</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">DD_belatedPNG.applyVML</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">event.propertyName</span><span class="PUNC">==</span><span class="STRN">"style.display"</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">b.currentStyle.display</span><span class="PUNC">==</span><span class="STRN">"none"</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="STRN">"none"</span><span class="PUNC">:</span><span class="STRN">"block"</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">b.vml</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.vml.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.vml</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">shape.style.display</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">event.propertyName.search</span><span class="PUNC">(</span><span class="STRN">"filter"</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">DD_belatedPNG.vmlOpacity</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">vmlOpacity</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.currentStyle.filter.search</span><span class="PUNC">(</span><span class="STRN">"lpha"</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b.currentStyle.filter</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">a.substring</span><span class="PUNC">(</span><span class="NAME">a.lastIndexOf</span><span class="PUNC">(</span><span class="STRN">"="</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">a.lastIndexOf</span><span class="PUNC">(</span><span class="STRN">")"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">100</span><span class="PUNC">;</span><span class="NAME">b.vml.color.shape.style.filter</span><span class="PUNC">=</span><span class="NAME">b.currentStyle.filter</span><span class="PUNC">;</span><span class="NAME">b.vml.image.fill.opacity</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">handlePseudoHover</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">DD_belatedPNG.applyVML</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">fix</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.screenStyleSheet</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.split</span><span class="PUNC">(</span><span class="STRN">","</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.screenStyleSheet.addRule</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"behavior:expression(DD_belatedPNG.fixPng(this))"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">applyVML</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.runtimeStyle.cssText</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">this.vmlFill</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.vmlOffsets</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.vmlOpacity</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.isImg</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.copyImageBorders</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">attachHandlers</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">resize</span><span class="PUNC">:</span><span class="STRN">"vmlOffsets"</span><span class="PUNC">,</span><span class="NAME">move</span><span class="PUNC">:</span><span class="STRN">"vmlOffsets"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i.nodeName</span><span class="PUNC">==</span><span class="STRN">"A"</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">mouseleave</span><span class="PUNC">:</span><span class="STRN">"handlePseudoHover"</span><span class="PUNC">,</span><span class="NAME">mouseenter</span><span class="PUNC">:</span><span class="STRN">"handlePseudoHover"</span><span class="PUNC">,</span><span class="NAME">focus</span><span class="PUNC">:</span><span class="STRN">"handlePseudoHover"</span><span class="PUNC">,</span><span class="NAME">blur</span><span class="PUNC">:</span><span class="STRN">"handlePseudoHover"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">i.attachEvent</span><span class="PUNC">(</span><span class="STRN">"on"</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">i.attachEvent</span><span class="PUNC">(</span><span class="STRN">"onpropertychange"</span><span class="PUNC">,</span><span class="NAME">this.readPropertyChange</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">giveLayout</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.style.zoom</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.currentStyle.position</span><span class="PUNC">==</span><span class="STRN">"static"</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.style.position</span><span class="PUNC">=</span><span class="STRN">"relative"</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">copyImageBorders</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">borderStyle</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="NAME">borderWidth</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="NAME">borderColor</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.vml.color.shape.style</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b.currentStyle</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">vmlFill</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">e.currentStyle</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">e.currentStyle</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">e.vml</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.vml.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e.vml</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">shape.style.zIndex</span><span class="PUNC">=</span><span class="NAME">d.zIndex</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">e.runtimeStyle.backgroundColor</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">e.runtimeStyle.backgroundImage</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d.backgroundImage</span><span class="PUNC">!=</span><span class="STRN">"none"</span><span class="PUNC">||</span><span class="NAME">e.isImg</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">e.isImg</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e.vmlBg</span><span class="PUNC">=</span><span class="NAME">d.backgroundImage</span><span class="PUNC">;</span><span class="NAME">e.vmlBg</span><span class="PUNC">=</span><span class="NAME">e.vmlBg.substr</span><span class="PUNC">(</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NAME">e.vmlBg.lastIndexOf</span><span class="PUNC">(</span><span class="STRN">'")'</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">5</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">e.vmlBg</span><span class="PUNC">=</span><span class="NAME">e.src</span><span class="PUNC">}</span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">g.imgSize</span><span class="PUNC">[</span><span class="NAME">e.vmlBg</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"img"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.imgSize</span><span class="PUNC">[</span><span class="NAME">e.vmlBg</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a.className</span><span class="PUNC">=</span><span class="NAME">g.ns</span><span class="PUNC">+</span><span class="STRN">"_sizeFinder"</span><span class="PUNC">;</span><span class="NAME">a.runtimeStyle.cssText</span><span class="PUNC">=</span><span class="STRN">"behavior:none; position:absolute; left:-10000px; top:-10000px; border:none; margin:0; padding:0;"</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.width</span><span class="PUNC">=</span><span class="NAME">this.offsetWidth</span><span class="PUNC">;</span><span class="NAME">this.height</span><span class="PUNC">=</span><span class="NAME">this.offsetHeight</span><span class="PUNC">;</span><span class="NAME">g.vmlOffsets</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">a.attachEvent</span><span class="PUNC">(</span><span class="STRN">"onload"</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.src</span><span class="PUNC">=</span><span class="NAME">e.vmlBg</span><span class="PUNC">;</span><span class="NAME">a.removeAttribute</span><span class="PUNC">(</span><span class="STRN">"width"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.removeAttribute</span><span class="PUNC">(</span><span class="STRN">"height"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">document.body.insertBefore</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">document.body.firstChild</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">e.vml.image.fill.src</span><span class="PUNC">=</span><span class="NAME">e.vmlBg</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">}</span><span class="NAME">e.vml.image.fill.on</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">e.vml.image.fill.color</span><span class="PUNC">=</span><span class="STRN">"none"</span><span class="PUNC">;</span><span class="NAME">e.vml.color.shape.style.backgroundColor</span><span class="PUNC">=</span><span class="NAME">d.backgroundColor</span><span class="PUNC">;</span><span class="NAME">e.runtimeStyle.backgroundImage</span><span class="PUNC">=</span><span class="STRN">"none"</span><span class="PUNC">;</span><span class="NAME">e.runtimeStyle.backgroundColor</span><span class="PUNC">=</span><span class="STRN">"transparent"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">vmlOffsets</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d.currentStyle</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">W</span><span class="PUNC">:</span><span class="NAME">d.clientWidth</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">:</span><span class="NAME">d.clientHeight</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">:</span><span class="NAME">this.imgSize</span><span class="PUNC">[</span><span class="NAME">d.vmlBg</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">width</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">:</span><span class="NAME">this.imgSize</span><span class="PUNC">[</span><span class="NAME">d.vmlBg</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">height</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">:</span><span class="NAME">d.offsetLeft</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">:</span><span class="NAME">d.offsetTop</span><span class="PUNC">,</span><span class="NAME">bLW</span><span class="PUNC">:</span><span class="NAME">d.clientLeft</span><span class="PUNC">,</span><span class="NAME">bTW</span><span class="PUNC">:</span><span class="NAME">d.clientTop</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">n.L</span><span class="PUNC">+</span><span class="NAME">n.bLW</span><span class="PUNC">==</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.coordsize</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">b.coordorigin</span><span class="PUNC">=</span><span class="NAME">u</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">u</span><span class="PUNC">;</span><span class="NAME">b.path</span><span class="PUNC">=</span><span class="STRN">"m0,0l"</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">+</span><span class="STRN">",0l"</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">s</span><span class="PUNC">+</span><span class="STRN">"l0,"</span><span class="PUNC">+</span><span class="NAME">s</span><span class="PUNC">+</span><span class="STRN">" xe"</span><span class="PUNC">;</span><span class="NAME">b.style.width</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">b.style.height</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">b.style.left</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">b.style.top</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">d.vml.color.shape</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">n.L</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">d.isImg</span><span class="PUNC">?</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">n.bLW</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">n.T</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">d.isImg</span><span class="PUNC">?</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">n.bTW</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">n.W</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">n.H</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">d.vml.image.shape</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">n.L</span><span class="PUNC">+</span><span class="NAME">n.bLW</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">n.T</span><span class="PUNC">+</span><span class="NAME">n.bTW</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">n.W</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">n.H</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">X</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Y</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d.isImg</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g.X</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">h.paddingLeft</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">g.Y</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">h.paddingTop</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.figurePercentage</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">[</span><span class="STRN">"backgroundPosition"</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">d.vml.image.fill.position</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">g.X</span><span class="PUNC">/</span><span class="NAME">n.W</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">g.Y</span><span class="PUNC">/</span><span class="NAME">n.H</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">h.backgroundRepeat</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">T</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">:</span><span class="NAME">n.W</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">:</span><span class="NAME">n.H</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">X</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">b1</span><span class="PUNC">:</span><span class="STRN">"L"</span><span class="PUNC">,</span><span class="NAME">b2</span><span class="PUNC">:</span><span class="STRN">"R"</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">:</span><span class="STRN">"W"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">Y</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">b1</span><span class="PUNC">:</span><span class="STRN">"T"</span><span class="PUNC">,</span><span class="NAME">b2</span><span class="PUNC">:</span><span class="STRN">"B"</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">:</span><span class="STRN">"H"</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">!=</span><span class="STRN">"repeat"</span><span class="PUNC">||</span><span class="NAME">d.isImg</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">T</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">g.Y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">g.X</span><span class="PUNC">+</span><span class="NAME">n.w</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">g.Y</span><span class="PUNC">+</span><span class="NAME">n.h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">g.X</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">m.search</span><span class="PUNC">(</span><span class="STRN">"repeat-"</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">m.split</span><span class="PUNC">(</span><span class="STRN">"repeat-"</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">toUpperCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">b1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">b2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i.B</span><span class="PUNC">></span><span class="NAME">n.H</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">i.B</span><span class="PUNC">=</span><span class="NAME">n.H</span><span class="PUNC">}</span><span class="NAME">d.vml.image.shape.style.clip</span><span class="PUNC">=</span><span class="STRN">"rect("</span><span class="PUNC">+</span><span class="NAME">i.T</span><span class="PUNC">+</span><span class="STRN">"px "</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">i.R</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"px "</span><span class="PUNC">+</span><span class="NAME">i.B</span><span class="PUNC">+</span><span class="STRN">"px "</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">i.L</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"px)"</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">d.vml.image.shape.style.clip</span><span class="PUNC">=</span><span class="STRN">"rect("</span><span class="PUNC">+</span><span class="NAME">f.T</span><span class="PUNC">+</span><span class="STRN">"px "</span><span class="PUNC">+</span><span class="NAME">f.R</span><span class="PUNC">+</span><span class="STRN">"px "</span><span class="PUNC">+</span><span class="NAME">f.B</span><span class="PUNC">+</span><span class="STRN">"px "</span><span class="PUNC">+</span><span class="NAME">f.L</span><span class="PUNC">+</span><span class="STRN">"px)"</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">figurePercentage</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">==</span><span class="STRN">"X"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="STRN">"left"</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="STRN">"top"</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="STRN">"center"</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="STRN">"right"</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="STRN">"bottom"</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.search</span><span class="PUNC">(</span><span class="STRN">"%"</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">100</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Math.ceil</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">?</span><span class="STRN">"W"</span><span class="PUNC">:</span><span class="STRN">"H"</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">?</span><span class="STRN">"w"</span><span class="PUNC">:</span><span class="STRN">"h"</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">%</span><span class="NUMB">2</span><span class="PUNC">===</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">++</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">fixPng</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c.style.behavior</span><span class="PUNC">=</span><span class="STRN">"none"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.nodeName</span><span class="PUNC">==</span><span class="STRN">"BODY"</span><span class="PUNC">||</span><span class="NAME">c.nodeName</span><span class="PUNC">==</span><span class="STRN">"TD"</span><span class="PUNC">||</span><span class="NAME">c.nodeName</span><span class="PUNC">==</span><span class="STRN">"TR"</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">}</span><span class="NAME">c.isImg</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.nodeName</span><span class="PUNC">==</span><span class="STRN">"IMG"</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.src.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">search</span><span class="PUNC">(</span><span class="REGX">/\.png$/</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c.isImg</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="NAME">c.style.visibility</span><span class="PUNC">=</span><span class="STRN">"hidden"</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.currentStyle.backgroundImage.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">search</span><span class="PUNC">(</span><span class="STRN">".png"</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">DD_belatedPNG</span><span class="PUNC">;</span><span class="NAME">c.vml</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">color</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">image</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">shape</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">fill</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">c.vml</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.vml.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">g.ns</span><span class="PUNC">+</span><span class="STRN">":"</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c.vml</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">c.vml</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">shape.stroked</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">c.vml</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">shape.appendChild</span><span class="PUNC">(</span><span class="NAME">c.vml</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">fill</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.parentNode.insertBefore</span><span class="PUNC">(</span><span class="NAME">c.vml</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">shape</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">c.vml.image.shape.fillcolor</span><span class="PUNC">=</span><span class="STRN">"none"</span><span class="PUNC">;</span><span class="NAME">c.vml.image.fill.type</span><span class="PUNC">=</span><span class="STRN">"tile"</span><span class="PUNC">;</span><span class="NAME">c.vml.color.fill.on</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">g.attachHandlers</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.giveLayout</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.giveLayout</span><span class="PUNC">(</span><span class="NAME">c.offsetParent</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.vmlInitiated</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="NAME">g.applyVML</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">document.execCommand</span><span class="PUNC">(</span><span class="STRN">"BackgroundImageCache"</span><span class="PUNC">,</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="NAME">DD_belatedPNG.createVmlNameSpace</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">DD_belatedPNG.createVmlStyleSheet</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span></pre></body></html>